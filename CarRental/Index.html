<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Rental</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="global.css">
    <script src="js/custom.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/css/bootstrap-datepicker.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1 class="text-center my-5">Car Rental Service</h1>
        <form id="rentalForm">
            <!-- Pickup & Drop-off Locations -->
            <div class="mb-3">
                <label for="pickupLocation" class="form-label">Pickup Location</label>
                <select class="form-select" id="pickupLocation" required>
                    <option value="" disabled selected>Select Pickup Location</option>
                    <option value="Pretoria">Pretoria</option>
                    <option value="Johannesburg">Johannesburg</option>
                    <option value="Durban">Durban</option>
                    <option value="Cape Town">Cape Town</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="dropoffLocation" class="form-label">Drop-off Location</label>
                <select class="form-select" id="dropoffLocation" required>
                    <option value="" disabled selected>Select Drop-off Location</option>
                    <option value="Pretoria">Pretoria</option>
                    <option value="Johannesburg">Johannesburg</option>
                    <option value="Durban">Durban</option>
                    <option value="Cape Town">Cape Town</option>
                </select>
            </div>

            <!-- Car Type -->
            <div class="mb-3">
                <label for="carType" class="form-label">Car Type</label>
                <select class="form-select" id="carType" required>
                    <option value="" disabled selected>Select Car Type</option>
                    <option value="sedan">Sedan</option>
                    <option value="suv">SUV</option>
                    <option value="convertible">Convertible</option>
                </select>
            </div>

            <!-- Rental Duration -->
            <div class="mb-3">
                <label for="km" class="form-label">Total Kilometers</label>
                <input type="number" class="form-control" id="km" min="1" required>
            </div>

            <!-- Pickup and Return Dates -->
            <div class="mb-3">
                <label for="pickupDate" class="form-label">Pickup Date</label>
                <input type="text" class="form-control datepicker" id="pickupDate" required>
            </div>

            <div class="mb-3">
                <label for="dropoffDate" class="form-label">Drop-off Date</label>
                <input type="text" class="form-control datepicker" id="dropoffDate" required>
            </div>

            <!-- Price -->
            <div class="mb-3">
                <label for="price" class="form-label">Price</label>
                <input type="text" class="form-control" id="price" disabled>
            </div>

            <!-- Payment Mode -->
            <div class="mb-3">
                <label for="paymentMode" class="form-label">Mode of Payment</label>
                <select class="form-select" id="paymentMode" required>
                    <option value="" disabled selected>Select Payment Mode</option>
                    <option value="cash">Cash</option>
                    <option value="card">Card</option>
                </select>
            </div>

            <!-- Cash Payment -->
            <div id="cashDetails" class="d-none">
                <div class="mb-3">
                    <label for="cashAmount" class="form-label">Amount (in USD)</label>
                    <input type="number" class="form-control" id="cashAmount" min="1" required>
                </div>
            </div>

            <!-- Card Details -->
            <div id="cardDetails" class="d-none">
                <div class="mb-3">
                    <label for="cardType" class="form-label">Card Type</label>
                    <select class="form-select" id="cardType" required>
                        <option value="" disabled selected>Select Card Type</option>
                        <option value="visa">Visa</option>
                        <option value="mastercard">MasterCard</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="cardNumber" class="form-label">Card Number</label>
                    <input type="text" class="form-control" id="cardNumber" pattern="\d{16}" title="16-digit card number" required>
                </div>
            </div>

            <button type="submit" class="btn btn-primary" id="submitButton" disabled>Rent Car</button>
        </form>

        <!-- Feedback Message -->
        <div id="feedback" class="alert alert-success mt-4 d-none">
            <strong>Success!</strong> Your car rental has been processed successfully.
        </div>
    </div>

    <!-- Load jQuery first -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Bootstrap Bundle (JS + Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Load Bootstrap Datepicker -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/js/bootstrap-datepicker.min.js"></script>

    <script>
        // Distance between cities (in km)
        const cityDistances = {
            "Pretoria": {
                "Johannesburg": 60,
                "Durban": 600,
                "Cape Town": 1400
            },
            "Johannesburg": {
                "Pretoria": 60,
                "Durban": 570,
                "Cape Town": 1300
            },
            "Durban": {
                "Pretoria": 600,
                "Johannesburg": 570,
                "Cape Town": 1600
            },
            "Cape Town": {
                "Pretoria": 1400,
                "Johannesburg": 1300,
                "Durban": 1600
            }
        };

        // Initialize date pickers for pickup and drop-off dates
        $(document).ready(function() {
            // Initialize the datepicker on both pickupDate and dropoffDate fields
            $('.datepicker').datepicker({
                format: 'mm/dd/yyyy',
                startDate: 'today',  // Disable past dates
                autoclose: true      // Auto-close after selecting a date
            });

            // Listen to changes in the pickup and dropoff locations
            $('#pickupLocation, #dropoffLocation').change(function() {
                calculatePrice();
            });

            $('#km').change(function() {
                calculatePrice();
            });

            $('#paymentMode').change(function() {
                togglePaymentFields();
            });

            $('#rentalForm').on('submit', function(event) {
                event.preventDefault();
                showFeedback();
            });
        });

        function calculatePrice() {
            const pickup = $('#pickupLocation').val();
            const dropoff = $('#dropoffLocation').val();
            const km = $('#km').val();

            if (pickup && dropoff && km) {
                const distance = cityDistances[pickup] && cityDistances[pickup][dropoff];
                if (distance) {
                    const pricePerKm = 2; // Example: price per kilometer
                    const price = distance * pricePerKm * km;
                    $('#price').val('$' + price.toFixed(2));
                    $('#submitButton').prop('disabled', false); // Enable the submit button
                }
            }
        }

        function togglePaymentFields() {
            const paymentMode = $('#paymentMode').val();
            if (paymentMode === 'cash') {
                $('#cashDetails').removeClass('d-none');
                $('#cardDetails').addClass('d-none');
            } else if (paymentMode === 'card') {
                $('#cashDetails').addClass('d-none');
                $('#cardDetails').removeClass('d-none');
            }
        }

        function showFeedback() {
            $('#feedback').removeClass('d-none');
            setTimeout(function() {
                $('#feedback').addClass('d-none');
            }, 5000);
        }
    </script>
</body>
</html>
